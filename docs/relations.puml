@startuml

package "trade.models" {
    class StockMarket {
        + id
        + name
    }
    class Portfolio {
        + id
        + name
        + amount
    }
    class PortfolioVersion {
        + id
        + portfolio_id
        + version
    }
    class TickerReturn {
        + id
        + ticker_id
        + open
        + high
        + low
        + close
        + volume
        + interval
        + change
        + percent_change
    }
    class Weight {
        + ticker_id
        + portfolio_version_id
        + position
        + planned_position
        + amount
        + locked_at
        + locked_at_amount
        + peacked_value
    }
    class Ticker {
        + name
        + exchange
        + company_name
        + exchange_name
        + type
        + type_display
        + industry
        + currency
    }
    class Order {
        + id
        + portfolio_id
        + ticker_id
        + executed_at
        + created_at
        + price
        + execution_size
        + execution_price
        + execution_value
        + execution_commission
    }
}

package "trade.sizers" {
    class WeightedPortfolioSizer
}

package "trade.strategies" {
    class Strategy {
        + Portfolio ID
    }
}

package "backtrade" {
    class Cerebro
}

object IBLifeTrading {
    + Portfolio ID
}

IBLifeTrading -> Cerebro : Initiailizes the instance
IBLifeTrading -> Portfolio : Loading required tickers to work with

Portfolio --{ PortfolioVersion

Cerebro -o Strategy : Takes Portfolio ID to work agains
Cerebro --o WeightedPortfolioSizer

' Strategy -> Portfolio :  As ID to pass over to Sizer
Strategy -* WeightedPortfolioSizer : Uses Portfolio ID to and ticker name to return the weight

PortfolioVersion --{ Weight
Ticker --{ Weight
Ticker --{ TickerReturn

Ticker --{ Order
Order }-- PortfolioVersion

WeightedPortfolioSizer -> Portfolio
WeightedPortfolioSizer -> Weight : fetch positions (ticker_name, portfolio_id)

@enduml